<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:等线;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:楷体_GB2312;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:̥_GB2312;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:DFKai-SB;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:华文新魏;
	panose-1:2 1 8 0 4 1 1 1 1 1;}
@font-face
	{font-family:方正姚体;
	panose-1:2 1 6 1 3 1 1 1 1 1;}
@font-face
	{font-family:幼圆;
	panose-1:2 1 5 9 6 1 1 1 1 1;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:微软雅黑;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:ˎ̥;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Courier New 宋体";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Segoe UI regular";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Seoge ui";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Myriad Pro";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Courier New ����";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:be;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:zm;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@等线";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@微软雅黑";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@楷体_GB2312";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Courier New 宋体";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"\@幼圆";
	panose-1:2 1 5 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@方正姚体";
	panose-1:2 1 6 1 3 1 1 1 1 1;}
@font-face
	{font-family:"\@华文新魏";
	panose-1:2 1 8 0 4 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;
	color:windowtext;}
h2
	{mso-style-name:"标题 2\,Heading 2 Hidden\,Heading 2 CCBS\,Titre3\,HD2\,H2\,h2\,Level 2 Topic Heading\,Heading 2 Hidden1\,Heading 2 CCBS1\,Titre31\,HD21\,H21\,h21\,Level 2 Topic Heading1\,节题";
	mso-style-link:"标题 2 字符1\,Heading 2 Hidden 字符1\,Heading 2 CCBS 字符1\,Titre3 字符1\,HD2 字符1\,H2 字符1\,h2 字符1\,Level 2 Topic Heading 字符1\,Heading 2 Hidden1 字符1\,Heading 2 CCBS1 字符1\,Titre31 字符1\,HD21 字符1\,H21 字符1\,h21 字符1\,Level 2 Topic Heading1 字符1\,节题 字符1";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:1.0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-1.0cm;
	line-height:150%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	color:windowtext;
	font-weight:bold;}
h3
	{mso-style-name:"标题 3\,Heading 3 - old\,sect1\.2\.3\,h3\,Level 3 Topic Heading\,Heading 3 - old1\,sect1\.2\.31\,h31\,Level 3 Topic Heading1\,\(分步\)\,\(小节\)";
	mso-style-link:"标题 3 字符2\,Heading 3 - old 字符2\,sect1\.2\.3 字符2\,h3 字符2\,Level 3 Topic Heading 字符2\,Heading 3 - old1 字符2\,sect1\.2\.31 字符2\,h31 字符2\,Level 3 Topic Heading1 字符2\,\(分步\) 字符2\,\(小节\) 字符2";
	margin-top:13.5pt;
	margin-right:0cm;
	margin-bottom:13.5pt;
	margin-left:78.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:-35.45pt;
	line-height:172%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;
	color:windowtext;
	font-weight:bold;}
span.MsoEndnoteReference
	{vertical-align:super;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
span.21
	{mso-style-name:"标题 2 字符1\,Heading 2 Hidden 字符1\,Heading 2 CCBS 字符1\,Titre3 字符1\,HD2 字符1\,H2 字符1\,h2 字符1\,Level 2 Topic Heading 字符1\,Heading 2 Hidden1 字符1\,Heading 2 CCBS1 字符1\,Titre31 字符1\,HD21 字符1\,H21 字符1\,h21 字符1\,Level 2 Topic Heading1 字符1\,节题 字符1";
	mso-style-link:"标题 2\,Heading 2 Hidden\,Heading 2 CCBS\,Titre3\,HD2\,H2\,h2\,Level 2 Topic Heading\,Heading 2 Hidden1\,Heading 2 CCBS1\,Titre31\,HD21\,H21\,h21\,Level 2 Topic Heading1\,节题";
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.4142515, li.4142515, div.4142515
	{mso-style-name:"样式 标题 4 + 段前\: 14\.25 磅 段后\: 15 磅";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.55pt;
	text-indent:-42.55pt;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	color:windowtext;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:21.0cm 808.0pt;
	margin:78.0pt 2.0cm 78.0pt 2.0cm;
	layout-grid:14.45pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink=purple style='word-wrap:break-word;text-justify-trim:
punctuation'>

<div class=WordSection1 style='layout-grid:14.45pt'>

<h2 style='margin-top:7.2pt;line-height:normal;layout-grid-mode:char'><a
name="_Ref148723174"></a><a name="_Toc121437283"></a><a name="_Ref127464199"></a><a
name="_Toc133146131"></a><a name="_Ref140931033"></a><a name="_Ref141016410"></a><a
name="_Ref141016414"></a><a name="_Ref141181940"></a><a name="_Ref141546673"></a><a
name="_Ref142492432"></a><a name="_Ref143761902"></a><a name="_Ref143871205"></a><a
name="_Ref146293660"></a><a name="_Ref148819092"></a><a name="_Ref150942342"></a><a
name="_Ref150986856"></a><a name="_Ref150986859"></a><a name="_Ref151845647"></a><a
name="_Ref151846620"></a><a name="_Ref152277646"></a><a name="_Ref152278054"></a><a
name="_Ref154522108"></a><a name="_Ref155692788"></a><a name="_Ref155692800"></a><a
name="_Ref155719417"></a><a name="_Ref155812732"></a><a name="_Ref156915726"></a><a
name="_Ref156918087"></a><a name="_Ref156919461"></a><a name="_Ref157118057"></a><a
name="_Ref157890916"></a><a name="_Ref166339633"></a><a name="_Ref174048108"></a><a
name="_Ref177406021"></a><a name="_Ref177406024"></a><a name="_Ref180571065"></a><a
name="_Ref181130334"></a><a name="_Ref183202326"></a><a name="_Ref185193588"></a><a
name="_Ref185626059"></a><a name="_Toc185882572"><span lang=EN-US
style='font-size:14.0pt;font-family:黑体'>6.2<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span lang=EN-US style='font-size:14.0pt;font-family:黑体'>ASP.Net
MVC</span></a><span style='font-size:14.0pt;font-family:黑体'>架构的创新研发：初创方的<span
lang=EN-US>0/1</span>语法的<span lang=EN-US>.exe/.dll</span>文件、他创方的<span
lang=EN-US>0/1</span>语法的<span lang=EN-US>.nupkg</span>文件、自创方的<span lang=EN-US>C#</span>语法的<span
lang=EN-US>.cs</span>文件</span></h2>

<p class=MsoNormal><span lang=EN-US style='font-size:11.0pt'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:11.0pt;font-family:宋体'>基于</span><span style='font-size:11.0pt;font-family:宋体'>表</span><span style='font-size:11.0pt'> <span
lang=EN-US>3‑9</span></span><span lang=EN-US style='font-size:11.0pt'>/</span><span style='font-size:11.0pt;font-family:宋体'>案例</span><span lang=EN-US
style='font-size:11.0pt'>6‑1</span><span style='font-size:11.0pt;font-family:
宋体'>，本节基于教育数字思维，探究</span><span
style='font-size:11.0pt;font-family:宋体'>表</span><span style='font-size:11.0pt'>
<span lang=EN-US>6‑1</span></span><span style='font-size:11.0pt;font-family:
黑体'>。</span></p>

<p class=MsoNormal align=center style='margin-top:6.0pt;margin-right:14.2pt;
margin-bottom:0cm;margin-left:21.25pt;margin-bottom:.0001pt;text-align:center;
text-indent:0cm;layout-grid-mode:char;word-break:break-all'><a
name="_Toc180710581"></a><a name="_Toc180710721"></a><a name="_Toc185882613"></a><a
name="_Ref150970790"><span style='font-size:10.0pt;font-family:黑体'>表 </span></a><span lang=EN-US style='font-size:10.0pt;font-family:黑体'>6</span><span lang=EN-US
style='font-size:10.0pt;font-family:黑体'>‑</span><span
lang=EN-US style='font-size:10.0pt;font-family:黑体'>1</span><span lang=EN-US
style='font-size:10.0pt;font-family:黑体'> </span><a name="_Ref161354131"></a><span lang=EN-US style='font-family:黑体'>ASP.Net MVC</span><span style='font-family:
黑体'>架构的创新研发：初创方的<span lang=EN-US>0/1</span>语法的<span lang=EN-US>.exe/.dll</span>文件、他创方的<span
lang=EN-US>0/1</span>语法的<span lang=EN-US>.nupkg</span>文件、自创方的<span lang=EN-US>C#</span>语法的<span
lang=EN-US>.cs</span>文件</span><span style='font-family:黑体'>（模型<span lang=EN-US>M</span>控制<span
lang=EN-US>C</span>视图<span lang=EN-US>V</span>的入口文件为例）</span></p>

<div align=center>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=132 valign=top style='width:99.0pt;border:solid windowtext 1.0pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-top:6.0pt;text-indent:0cm;layout-grid-mode:
  char;word-break:break-all'><b><span
  lang=EN-US style='font-size:10.0pt;font-family:黑体;color:black'>ASP.Net MVC</span></b><b><span
  style='font-size:10.0pt;font-family:黑体;color:black'>架构的视图<span lang=EN-US>V</span>的创新研发：<span
  lang=EN-US>“</span>客户端的<span lang=EN-US>Edge</span>浏览器宿主的视图<span lang=EN-US>V</span>宿客”的<span
  lang=EN-US>C#</span>语言思维</span></b></p>
  </td>
  <td width=378 valign=top style='width:10.0cm;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:7.2pt;text-align:center;
  text-indent:0cm;word-break:break-all'><span
  lang=EN-US style='font-size:10.0pt;font-family:黑体;color:black'>ASP.Net MVC</span><span
  style='font-size:10.0pt;font-family:黑体;color:black'>架构的控制<span lang=EN-US>C</span>的创新研发：</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>“</span><span
  style='font-size:10.0pt;font-family:黑体;color:black'>互动的<span lang=EN-US>Kestrel/</span></span><span
  lang=EN-US style='font-size:11.0pt;font-family:黑体;color:black'>IIS</span><span
  style='font-size:11.0pt;font-family:黑体;color:black'>宿主的控制<span lang=EN-US>C</span>宿客”的<span
  lang=EN-US>C#</span>语言思维</span></p>
  <p class=MsoNormal align=center style='margin-top:6.0pt;text-align:center;
  text-indent:0cm;layout-grid-mode:char;word-break:break-all'><span lang=EN-US
  style='font-size:10.0pt;font-family:黑体'>&nbsp;</span></p>
  </td>
  <td width=132 valign=top style='width:98.95pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:7.2pt;text-align:center;
  text-indent:0cm;word-break:break-all'><span
  lang=EN-US style='font-size:10.0pt;font-family:黑体;color:black'>ASP.Net MVC</span><span
  style='font-size:10.0pt;font-family:黑体;color:black'>架构的模型<span lang=EN-US>M</span>的创新研发：</span><span
  lang=EN-US style='font-size:10.0pt;color:black'>“</span><span
  style='font-size:10.0pt;font-family:黑体;color:black'>服务端的<span lang=EN-US>SS/ChatGPT/</span></span><span
  lang=EN-US style='font-size:10.0pt;font-family:黑体;color:black'>Qwen</span><span
  style='font-size:10.0pt;font-family:黑体;color:black'>宿主的模型<span lang=EN-US>M</span>宿客”的<span
  lang=EN-US>C</span></span><span lang=EN-US style='font-size:10.0pt;
  font-family:黑体;color:black'>#</span><span style='font-size:10.0pt;font-family:
  宋体;color:black'>语言思维</span></p>
  </td>
 </tr>
 <tr>
  <td width=132 valign=top style='width:99.0pt;border:solid windowtext 1.0pt;
  border-top:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:7.2pt;text-align:center;
  text-indent:0cm;word-break:break-all'><span style='font-size:10.0pt;
  font-family:黑体;color:black'>客户端</span></p>
  </td>
  <td width=510 colspan=2 valign=top style='width:382.45pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-top:7.2pt;text-align:center;
  text-indent:0cm;word-break:break-all'><span style='font-size:10.0pt;
  font-family:黑体;color:black'>（互动）服务端</span></p>
  </td>
 </tr>
 <tr>
  <td width=642 colspan=3 valign=top style='width:481.45pt;border:solid windowtext 1.0pt;
  border-top:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center;text-indent:0cm'><b><span
  lang=EN-US style='color:black'><img width=576 height=337
  src="1690449211937.files/image001.png"></span></b></p>
  <p class=MsoNormal align=center style='text-align:center;text-indent:0cm'><a
  name="_Toc180695321"></a><a name="_Toc186017975"></a><a name="_Ref161354288"><span
  style='font-size:9.5pt;font-family:黑体;color:black'>图</span></a><span lang=EN-US style='font-size:9.5pt;font-family:黑体;color:black'>6</span><span
  lang=EN-US style='font-size:9.5pt;font-family:黑体;color:black'>‑</span><span
  lang=EN-US style='font-size:9.5pt;font-family:黑体;color:black'>10</span><span
  lang=EN-US style='font-size:9.5pt;font-family:黑体;color:black'> </span><span
  lang=EN-US style='font-size:9.5pt;font-family:黑体;color:black'>ASP.Net MVC</span><span
  style='font-size:9.5pt;font-family:黑体;color:black'>架构的创新研发：初创方的<span
  lang=EN-US>0/1</span>语法的<span lang=EN-US>.exe/.dll</span>文件、他创方的<span
  lang=EN-US>0/1</span>语法的<span lang=EN-US>.nupkg</span>文件、自创方的<span
  lang=EN-US>C#</span>语法的<span lang=EN-US>.cs</span>文件（模型<span lang=EN-US>M</span>控制<span
  lang=EN-US>C</span>视图<span lang=EN-US>V</span>的入口文件为例）</span></p>
  </td>
 </tr>
 <tr>
  <td width=132 valign=top style='width:99.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm;word-break:break-all'><span
  style='font-size:10.0pt;font-family:宋体'>图<span lang=EN-US>6‑10</span></span><span
  style='font-size:10.0pt;font-family:宋体'>所示，客户端运行的视图<span lang=EN-US>V</span>（</span><span
  lang=EN-US style='font-size:10.0pt;font-family:宋体'>6.3</span><span
  style='font-size:10.0pt;font-family:宋体'>节细化），涉及</span><span lang=EN-US
  style='font-size:10.0pt;font-family:黑体'>Word</span><span style='font-size:
  10.0pt;font-family:黑体'>宿主的<span lang=EN-US>Word.Net</span>平台<span lang=EN-US>C#</span>语言</span><span
  class=MsoEndnoteReference><span lang=EN-US style='font-size:10.0pt'>[</span></span><a
  href="#_edn1" name="_ednref1" title=""><span lang=EN-US style='font-size:
  10.5pt;font-family:"Times New Roman",serif'>[1]</span></a><span
  class=MsoEndnoteReference><span lang=EN-US style='font-size:10.0pt'>]</span></span><span
  style='font-size:10.0pt;font-family:宋体'>。例如，</span><span style='font-size:
  10.0pt;font-family:宋体'>图中<span lang=EN-US>wwwroot</span>文件夹下</span><span
  lang=EN-US style='font-size:10.0pt'>ThisAddIn.cs</span><span
  style='font-size:10.0pt;font-family:宋体'>文件中</span><span lang=EN-US
  style='font-size:10.0pt'>ThisAddIn</span><span style='font-size:10.0pt;
  font-family:宋体'>对象类型的</span><span lang=EN-US style='font-size:10.0pt'>ThisAddin_Startup</span><span
  style='font-size:10.0pt;font-family:宋体'>方法作为入口，基本代码如下：</span></p>
  </td>
  <td width=510 colspan=2 valign=top style='width:382.45pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='text-indent:0cm'><span
  style='font-size:10.0pt;font-family:宋体'>图<span lang=EN-US>6‑10</span></span><span
  style='font-size:10.0pt;font-family:宋体'>所示，互动控制<span lang=EN-US>C</span>（</span><span lang=EN-US style='font-size:10.0pt;font-family:宋体'>6.4</span><span
  style='font-size:10.0pt;font-family:宋体'>节细化）、服务端模型<span lang=EN-US>M</span>（</span><span lang=EN-US style='font-size:10.0pt;font-family:宋体'>6.5</span><span
  style='font-size:10.0pt;font-family:宋体'>节细化），涉及图中<span lang=EN-US>Program.cs</span>文件中的<span
  lang=EN-US>Program</span>对象类型的<span lang=EN-US>Main</span>方法作为入口。主要涉及<span
  lang=EN-US>Main</span>方法中的<span lang=EN-US>Startup/ConfigureServices/Configure</span>、</span><span
  style='font-size:11.0pt;font-family:宋体'>服务<span lang=EN-US>DI</span>容器、<span
  lang=EN-US>Web</span>服务宿主、<span lang=EN-US>Web HTTP</span>服务管道中间件、数据库服务初始化、日志初始化、选项、登录初始化、<span
  lang=EN-US>URL</span>路由、配置、环境、错误处理、<span lang=EN-US>HTTP</span>请求、内容根目录、<span
  lang=EN-US>Web</span>根目录、<span lang=EN-US>HttpContext</span>、<span
  lang=EN-US>Native AOT</span>，等等</span><sup><span lang=EN-US style='font-size:
  11.0pt'>[</span></sup><a href="#_edn2" name="_ednref2" title=""><span
  class=MsoEndnoteReference><span lang=EN-US style='font-size:11.0pt'><span
  class=MsoEndnoteReference><span lang=EN-US style='font-size:11.0pt;
  font-family:"Times New Roman",serif'>[2]</span></span></span></span></a><sup><span
  lang=EN-US style='font-size:11.0pt'>]</span></sup><span style='font-size:
  10.0pt;font-family:宋体'>。</span></p>
  <p class=MsoNormal style='margin-top:6.0pt;text-indent:0cm;layout-grid-mode:
  char'><span lang=EN-US style='font-size:10.0pt;font-family:宋体'>Program</span><span
  style='font-size:10.0pt;font-family:宋体'>对象类型的<span lang=EN-US>Main</span>方法的基本代码案例如下：</span></p>
  </td>
 </tr>
 <tr>
  <td width=132 valign=top style='width:99.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using System;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using
  System.Collections.Generic;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using
  System.Linq;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using System.Text;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using
  System.Xml.Linq;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using Word =
  Microsoft.Office.Interop.Word;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using Office =
  Microsoft.Office.Core;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using
  Microsoft.Office.Tools.Word;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>using
  System.Windows.Forms;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>namespace
  YuQinWordAddInClient</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>{</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>    public
  partial class ThisAddIn</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>    {</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        private
  void ThisAddIn_Startup(object sender, System.EventArgs e)</span><span
  lang=EN-US style='font-size:10.0pt'> </span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        {</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>           //
  MessageBox.Show(&quot;Hello,VSTO!&quot;);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        }</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        private
  void ThisAddIn_Shutdown(object sender, System.EventArgs e)</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        {</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        }</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        #region
  VSTO generated code</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        ///
  &lt;summary&gt;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        ///
  Required method for Designer support - do not modify</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        /// the
  contents of this method with the code editor.</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        ///
  &lt;/summary&gt;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        private
  void InternalStartup()</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        {</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>           //
  this.Startup += new System.EventHandler(ThisAddIn_Startup);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>           //
  this.Shutdown += new System.EventHandler(ThisAddIn_Shutdown);</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        }</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>        </span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>       
  #endregion</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>    }</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:10.0pt'>}</span></p>
  <p class=MsoNormal align=left style='margin-top:7.2pt;text-align:left;
  text-indent:0cm'><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-top:7.2pt;text-align:left;
  text-indent:0cm'><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></p>
  </td>
  <td width=510 colspan=2 valign=top style='width:382.45pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='margin-left:1.7pt;text-align:left;
  text-indent:-1.7pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>//using System</span><span style='font-size:10.0pt;font-family:宋体'>等等名称空间别名简写的声明定义的语句的代码，在此省略！</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>namespace WebEdu_LocalVersion_YuQin_DotNetCore2._1</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>{</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>    public class Program</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>    {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        public static Int32 iTry { get; set; } = 0;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        public static IConfiguration Configuration { get; set; }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        public static
  Microsoft.AspNetCore.Hosting.IHostingEnvironment HostingEnvironment { get;
  set; }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        public static ILoggerFactory LoggerFactory { get; set; }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        //public static IServiceCollection services { get; set; } =
  new Microsoft.Extensions.DependencyInjection.ServiceCollection();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        // public static void Main(String[] args, IConfiguration
  configuration, Microsoft.AspNetCore.Hosting.IHostingEnvironment
  hostingEnvironment)//</span><span style='font-size:10.0pt;font-family:宋体'>不支持</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        public static void Main(String[] args)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //Random random = new Random();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //Int32 portNum = random.Next(5000, 6000);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //return
  WebHost.CreateDefaultBuilder(args).UseStartup&lt;Startup&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            // Int32 seed = 6;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //Random random = new Random(seed);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            Random random = new Random();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            Int32 portNum = random.Next(5000, 6000);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            String urls = &quot;http://localhost:&quot; +
  portNum.ToString() + &quot;;https://localhost:&quot; + (portNum +
  1).ToString() + &quot;;http://*:&quot; + portNum.ToString() +
  &quot;;https://*:&quot; + (portNum + 1).ToString();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>//KernelBuilder kernelBuilder = new KernelBuilder();//</span><span
  style='font-size:10.0pt;font-family:宋体'>人工只能</span><span lang=EN-US
  style='font-size:10.0pt'>AI</span><span style='font-size:10.0pt;font-family:
  宋体'>相关的服务</span><span lang=EN-US style='font-size:10.0pt'>DI</span><span
  style='font-size:10.0pt;font-family:宋体'>。通过</span><span lang=EN-US
  style='font-size:10.0pt'> KernelBuilder </span><span style='font-size:10.0pt;
  font-family:宋体'>中的</span><span lang=EN-US style='font-size:10.0pt'>
  WithAzureTextCompletionService </span><span style='font-size:10.0pt;
  font-family:宋体'>来配置模型。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>           //kernelBuilder.WithAzureTextCompletionService(&quot;Azure
  OpenAT Deployment Name:yuqin&quot;,
  &quot;https://yuqin.openai.azure.com/&quot;, &quot;yuqin</span><span
  style='font-size:10.0pt;font-family:宋体'>的</span><span lang=EN-US
  style='font-size:10.0pt'>Azure OpenAI Key&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>           
  //kernelBuilder.WithOpenAITextCompletionService(&quot;text-davinci-93&quot;,
  &quot;...My OpenAI API Key...&quot;); //</span><span style='font-size:10.0pt;
  font-family:宋体'>使用</span><span lang=EN-US style='font-size:10.0pt'>OpenAI
  Model</span><span style='font-size:10.0pt;font-family:宋体'>模型时选择。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            // kernelBuilder.WithAzureChatCompletionService()//</span><span
  style='font-size:10.0pt;font-family:宋体'>使用</span><span lang=EN-US
  style='font-size:10.0pt'>gpt3.5</span><span style='font-size:10.0pt;
  font-family:宋体'>或</span><span lang=EN-US style='font-size:10.0pt'>gpt4</span><span
  style='font-size:10.0pt;font-family:宋体'>对话模型时选择。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //kernelBuilder.WithAzureOpenAIImageGenerationService()//</span><span
  style='font-size:10.0pt;font-family:宋体'>使用</span><span lang=EN-US
  style='font-size:10.0pt'>DallE</span><span style='font-size:10.0pt;
  font-family:宋体'>图像生成模型时选择。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>           
  //kernelBuilder.WithAzureTectEmbeddingGenerationService()//</span><span
  style='font-size:10.0pt;font-family:宋体'>使用向量化嵌入模型时选择。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            IWebHostBuilder webHostBuilder =
  WebHost.CreateDefaultBuilder(args);//</span><span style='font-size:10.0pt;
  font-family:宋体'>创建一个</span><span lang=EN-US style='font-size:10.0pt'>Web</span><span
  style='font-size:10.0pt;font-family:宋体'>主机构造器对象。</span><span lang=EN-US
  style='font-size:10.0pt'>                </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            webHostBuilder.UseKestrel(///Web</span><span
  style='font-size:10.0pt;font-family:宋体'>主机构造器对象使用</span><span lang=EN-US
  style='font-size:10.0pt'>Kestrel</span><span style='font-size:10.0pt;
  font-family:宋体'>作为</span><span lang=EN-US style='font-size:10.0pt'>Web</span><span
  style='font-size:10.0pt;font-family:宋体'>服务器（</span><span lang=EN-US
  style='font-size:10.0pt'>.Net core</span><span style='font-size:10.0pt;
  font-family:宋体'>内置</span><span lang=EN-US style='font-size:10.0pt'>Kestrel</span><span
  style='font-size:10.0pt;font-family:宋体'>这一</span><span lang=EN-US
  style='font-size:10.0pt'>Web</span><span style='font-size:10.0pt;font-family:
  宋体'>服务器）。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                delegate (KestrelServerOptions
  kestrelServerOptions)//</span><span style='font-size:10.0pt;font-family:宋体'>配置</span><span
  lang=EN-US style='font-size:10.0pt'>Kestrel</span><span style='font-size:
  10.0pt;font-family:宋体'>服务器。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    kestrelServerOptions.Limits.MaxRequestBodySize =
  209715200;//</span><span style='font-size:10.0pt;font-family:宋体'>硬编码配置</span><span
  lang=EN-US style='font-size:10.0pt'>Kestrel</span><span style='font-size:
  10.0pt;font-family:宋体'>服务。最大的请求长度设置为</span><span lang=EN-US style='font-size:
  10.0pt'>200M</span><span style='font-size:10.0pt;font-family:宋体'>。上传</span><span
  lang=EN-US style='font-size:10.0pt'>200M</span><span style='font-size:10.0pt;
  font-family:宋体'>文件的限制。</span><span lang=EN-US style='font-size:10.0pt'>//</span><span
  style='font-size:10.0pt;font-family:宋体'>如果发布到</span><span lang=EN-US
  style='font-size:10.0pt'>IIS</span><span style='font-size:10.0pt;font-family:
  宋体'>等服务器，可能还需要</span><span lang=EN-US style='font-size:10.0pt'>Web.config</span><span
  style='font-size:10.0pt;font-family:宋体'>中</span><span lang=EN-US
  style='font-size:10.0pt'>&lt;system.webServer&gt;  &lt; security &gt;    &lt;
  requestFiltering &gt;      &lt; requestLimits maxAllowedContentLength =
  &quot;209715200&quot; /&gt;     &lt;/ requestFiltering &gt;   &lt;/ security
  &gt; &lt;/ system.webServer &gt;  </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    kestrelServerOptions.Configure(new
  ConfigurationBuilder().Build().GetSection(&quot;Kestrel&quot;));//</span><span
  style='font-size:10.0pt;font-family:宋体'>也可读取软编码于</span><span lang=EN-US
  style='font-size:10.0pt'>AppSetting.json</span><span style='font-size:10.0pt;
  font-family:宋体'>及其</span><span lang=EN-US style='font-size:10.0pt'>AppSetting.{</span><span
  style='font-size:10.0pt;font-family:宋体'>环境变量</span><span lang=EN-US
  style='font-size:10.0pt'>}.json</span><span style='font-size:10.0pt;
  font-family:宋体'>中中的</span><span lang=EN-US style='font-size:10.0pt'>Kestrel</span><span
  style='font-size:10.0pt;font-family:宋体'>设置。尚未验证！</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>         )</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>         .UseIISIntegration()</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>#if DEBUG</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>         
  .UseUrls(&quot;http://localhost:5000;https://localhost:5001;http://*:5000;https://*:5001&quot;)//</span><span
  style='font-size:10.0pt;font-family:宋体'>指定</span><span lang=EN-US
  style='font-size:10.0pt'>Kestrel</span><span style='font-size:10.0pt;
  font-family:宋体'>将侦听的</span><span lang=EN-US style='font-size:10.0pt'>URL</span><span
  style='font-size:10.0pt;font-family:宋体'>。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>#else</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>          .UseUrls(urls) </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>#endif          </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>          .ConfigureLogging(//</span><span style='font-size:10.0pt;
  font-family:宋体'>配置</span><span lang=EN-US style='font-size:10.0pt'>Web</span><span
  style='font-size:10.0pt;font-family:宋体'>服务器的日志。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                delegate (WebHostBuilderContext
  webHostBuilderContext, ILoggingBuilder loggingBuilder)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // Requires `using Microsoft.Extensions.Logging;`</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                   
  loggingBuilder.AddConfiguration(webHostBuilderContext.Configuration.GetSection(&quot;Logging&quot;));//</span><span
  style='font-size:10.0pt;font-family:宋体'>调用</span><span lang=EN-US
  style='font-size:10.0pt'>Appsetings.json</span><span style='font-size:10.0pt;
  font-family:宋体'>中的日志软配置</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    loggingBuilder.AddConsole(); //</span><span
  style='font-size:10.0pt;font-family:宋体'>其实会自动隐式配置本日志配置。</span><span
  lang=EN-US style='font-size:10.0pt'>                   </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    loggingBuilder.AddDebug();//</span><span
  style='font-size:10.0pt;font-family:宋体'>其实会自动隐式配置本日志配置。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    loggingBuilder.AddEventSourceLogger();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            webHostBuilder.ConfigureAppConfiguration(delegate
  (WebHostBuilderContext webHostBuilderContext, IConfigurationBuilder
  configurationBuilder) </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                HostingEnvironment =
  webHostBuilderContext.HostingEnvironment;//</span><span style='font-size:
  10.0pt;font-family:宋体'>没通过，所以后续</span><span lang=EN-US style='font-size:10.0pt'>ConfigureServices()
  </span><span style='font-size:10.0pt;font-family:宋体'>、</span><span
  lang=EN-US style='font-size:10.0pt'>Configure()</span><span style='font-size:
  10.0pt;font-family:宋体'>都没能通过。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                Configuration = configurationBuilder.Build();//</span><span
  style='font-size:10.0pt;font-family:宋体'>没通过，所以后续</span><span lang=EN-US
  style='font-size:10.0pt'>ConfigureServices() </span><span style='font-size:
  10.0pt;font-family:宋体'>、</span><span lang=EN-US style='font-size:10.0pt'>Configure()</span><span
  style='font-size:10.0pt;font-family:宋体'>都没能通过。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                                             //
  iTry=2;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                                             // 
  CTemp cTemp = new CTemp();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                                             // 
  CTemp.HostingEnvironment= webHostBuilderContext.HostingEnvironment;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                                             //
  CTemp.Configuration = configurationBuilder.Build();           </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>//</span><span style='font-size:10.0pt;font-family:宋体'>初创方</span><span
  lang=EN-US style='font-size:10.0pt'>ASP.NET</span><span style='font-size:
  10.0pt;font-family:宋体'>内置了</span><span lang=EN-US style='font-size:10.0pt'>250
  </span><span style='font-size:10.0pt;font-family:宋体'>个以上的服务可供</span><span
  lang=EN-US style='font-size:10.0pt'>DI</span><span style='font-size:10.0pt;
  font-family:宋体'>依赖注入</span><sup><span lang=EN-US style='font-size:10.0pt'>[</span></sup><a
  href="#_edn3" name="_ednref3" title=""><span lang=EN-US style='font-size:
  10.5pt;font-family:"Times New Roman",serif'>[3]</span></a><sup><span
  lang=EN-US style='font-size:10.0pt'>]</span></sup><span style='font-size:
  10.0pt;font-family:宋体'>。而且可以遵守规则自创方开发服务的</span><span lang=EN-US
  style='font-size:10.0pt'>DI</span><span style='font-size:10.0pt;font-family:
  宋体'>。本书涉及的主要的服务</span><span lang=EN-US style='font-size:10.0pt'>DI</span><span
  style='font-size:10.0pt;font-family:宋体'>如下。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            webHostBuilder.ConfigureServices(delegate
  (IServiceCollection serviceCollection) </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                serviceCollection.AddSignalR();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.Configure&lt;CookiePolicyOptions&gt;(</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                  delegate (CookiePolicyOptions cookiePolicyOptions)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                  {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                      {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                          cookiePolicyOptions.CheckConsentNeeded =
  delegate (HttpContext context) { return true; };</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                          cookiePolicyOptions.MinimumSameSitePolicy =
  SameSiteMode.None;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                      }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                  }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                  );</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                serviceCollection.AddLogging();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                String sLocalDatabasePathDefault =
  &quot;Filename=&quot; + HostingEnvironment.WebRootPath +
  Configuration.GetConnectionString(&quot;PartPathOfLocalDatabaseDefault&quot;);             
  </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.AddDbContext&lt;BroweringOfTextbookDbContext&gt;(delegate
  (DbContextOptionsBuilder dbContextOptionsBuilder) {
  dbContextOptionsBuilder.UseSqlite(sLocalDatabasePathDefault); });//SQLite</span><span
  style='font-size:10.0pt;font-family:宋体'>嵌入式数据库连接</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                String sLocalDatabasePathOfAdmin =
  &quot;Filename=&quot; + HostingEnvironment.WebRootPath +
  Configuration.GetConnectionString(&quot;PartPathOfLocalDatabaseOfAdmin&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.AddDbContext&lt;AdminDbContext&gt;(delegate
  (DbContextOptionsBuilder dbContextOptionsBuilder) {
  dbContextOptionsBuilder.UseSqlite(sLocalDatabasePathOfAdmin); });//</span><span
  style='font-size:10.0pt;font-family:宋体'>试验</span><span lang=EN-US
  style='font-size:10.0pt'>SQLite</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                serviceCollection.Configure&lt;FormOptions&gt;(x
  =&gt;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                { </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    x.ValueLengthLimit = Int32.MaxValue;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    x.MultipartBodyLengthLimit = Int32.MaxValue;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    x.MultipartHeadersLengthLimit = int.MaxValue;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    x.MemoryBufferThreshold = int.MaxValue;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                //Indentity</span><span style='font-size:10.0pt;
  font-family:宋体'>所需的</span><span lang=EN-US style='font-size:10.0pt'>SQL</span><span
  style='font-size:10.0pt;font-family:宋体'>数据库</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.AddDbContext&lt;IdentityDemo.Data.IdentityApplicationDbContext&gt;(delegate
  (DbContextOptionsBuilder dbContextOptionsBuilder) {
  dbContextOptionsBuilder.UseSqlServer(Configuration.GetConnectionString(&quot;IdentityApplicationDbContext&quot;));
  });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.AddIdentity&lt;IdentityDemo.Models.ApplicationIdentityUser,
  IdentityRole&gt;()</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>              
  .AddEntityFrameworkStores&lt;IdentityDemo.Data.IdentityApplicationDbContext&gt;()</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               .AddDefaultTokenProviders();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>               
  serviceCollection.Configure&lt;IdentityOptions&gt;(options =&gt;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // Password settings</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequireDigit = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequiredLength = 8;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequireNonAlphanumeric = false;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequireUppercase = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequireLowercase = false;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Password.RequiredUniqueChars = 6;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // Lockout settings</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Lockout.DefaultLockoutTimeSpan =
  TimeSpan.FromMinutes(30);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Lockout.MaxFailedAccessAttempts = 10;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Lockout.AllowedForNewUsers = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // User settings</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.User.RequireUniqueEmail = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                serviceCollection.ConfigureApplicationCookie(options
  =&gt;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // Cookie settings</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Cookie.HttpOnly = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.Cookie.Expiration =
  TimeSpan.FromDays(150);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // If the LoginPath isn't set, ASP.NET Core
  defaults </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // the path to /Account/Login.</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.LoginPath = &quot;/Account/Login&quot;;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // If the AccessDeniedPath isn't set, ASP.NET
  Core defaults </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    // the path to /Account/AccessDenied.</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.AccessDeniedPath =
  &quot;/Account/AccessDenied&quot;;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    options.SlidingExpiration = true;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                // Add application services.</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                serviceCollection.AddTransient&lt;IEmailSender,
  EmailSender&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                //</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                using (IServiceScope serviceScope =
  serviceCollection.BuildServiceProvider().CreateScope())</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    IServiceProvider serviceProvider =
  serviceScope.ServiceProvider;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    try</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        // MovieDbContext dBContext =
  services.GetRequiredService&lt;MovieDbContext&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        BroweringOfTextbookDbContext
  broweringOfTextbookDbContext =
  serviceProvider.GetRequiredService&lt;BroweringOfTextbookDbContext&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                               
  broweringOfTextbookDbContext.Database.EnsureCreated();//</span><span
  style='font-size:10.0pt;font-family:宋体'>连接</span><span lang=EN-US
  style='font-size:10.0pt'>SQLite</span><span style='font-size:10.0pt;
  font-family:宋体'>、</span><span lang=EN-US style='font-size:10.0pt'>SQL Server
  Express</span><span style='font-size:10.0pt;font-family:宋体'>都可通过。创建数据库，也创建了数据库表。但无迁移功能。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                       
  BroweringOfTextbookSeedData.Initialize(serviceProvider);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        AdminDbContext adminDBContext =
  serviceProvider.GetRequiredService&lt;AdminDbContext&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        adminDBContext.Database.EnsureCreated();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        AdminSeedData.Initialize(serviceProvider);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    catch (Exception ex)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        var logger =
  serviceProvider.GetRequiredService&lt;ILogger&lt;Program&gt;&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        logger.LogError(ex, &quot;An error occurred
  seeding the DB.&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    finally</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        ;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                //*******************</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>//</span><span style='font-size:10.0pt;font-family:宋体'>初创方</span><span
  lang=EN-US style='font-size:10.0pt'>ASP.NET</span><span style='font-size:
  10.0pt;font-family:宋体'>内置了众多万维网</span><span lang=EN-US style='font-size:10.0pt'>HTTP</span><span
  style='font-size:10.0pt;font-family:宋体'>服务中间件以供配置使用</span><sup><span
  lang=EN-US style='font-size:10.0pt'>[</span></sup><a href="#_edn4"
  name="_ednref4" title=""><span lang=EN-US style='font-size:10.5pt;font-family:
  "Times New Roman",serif'>[4]</span></a><sup><span lang=EN-US
  style='font-size:10.0pt'>]</span></sup><span style='font-size:10.0pt;
  font-family:宋体'>。当然也可遵守规则自创方开发</span><span lang=EN-US style='font-size:10.0pt'>HTTP</span><span
  style='font-size:10.0pt;font-family:宋体'>服务中间件。本书涉及的主要的万维网</span><span
  lang=EN-US style='font-size:10.0pt'>HTTP</span><span style='font-size:10.0pt;
  font-family:宋体'>服务中间件如下。</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            webHostBuilder.Configure(delegate (IApplicationBuilder
  applicationBuilder) </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                 {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     if (HostingEnvironment.IsDevelopment())</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        
  applicationBuilder.UseDeveloperExceptionPage();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     else</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        
  applicationBuilder.UseExceptionHandler(&quot;/Home/Error&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                         applicationBuilder.UseHsts();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseHttpsRedirection();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseStaticFiles();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseCookiePolicy();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     // applicationBuilder.UseAuthentication();//</span><span
  style='font-size:10.0pt;font-family:宋体'>登录认证管道</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseAuthentication();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseMvc(delegate
  (IRouteBuilder routeBuilder)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                         {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                             {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                 //</span><span style='font-size:
  10.0pt;font-family:宋体'>区域</span><span lang=EN-US style='font-size:10.0pt'>Areas</span><span
  style='font-size:10.0pt;font-family:宋体'>的路由。必须在非区域</span><span lang=EN-US
  style='font-size:10.0pt'>Areas</span><span style='font-size:10.0pt;
  font-family:宋体'>的路由前面定义</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                 routeBuilder.MapRoute(</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    name: &quot;defaultWithArea&quot;,</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    template:
  &quot;{area:exists}/{controller=Home}/{action=Index}/{id?}&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                 //</span><span style='font-size:
  10.0pt;font-family:宋体'>非区域</span><span lang=EN-US style='font-size:10.0pt'>Areas</span><span
  style='font-size:10.0pt;font-family:宋体'>的路由</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                 routeBuilder.MapRoute(</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                     name: &quot;default&quot;,</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                                     template:
  &quot;{controller=Home}/{action=Index}/{id?}&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                             }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                         });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     /**</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseEndpoints(endpoints =&gt;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        
  endpoints.MapHub&lt;ChatHub&gt;(&quot;/chat&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     **/</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     applicationBuilder.UseSignalR(routes =&gt;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        
  routes.MapHub&lt;ChatHub&gt;(&quot;/chat&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     });</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     //
  Microsoft.AspNetCore.Hosting.IHostingEnvironment hostingEnvironment =
  applicationBuilder.ApplicationServices.GetRequiredService&lt;Microsoft.AspNetCore.Hosting.IHostingEnvironment&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    
  Microsoft.Extensions.Configuration.IConfiguration configuration =
  applicationBuilder.ApplicationServices.GetRequiredService&lt;IConfiguration&gt;();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     //ILogger logger =
  LoggerFactory.CreateLogger(&quot;TryLog&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                     //logger.LogInformation(&quot;Logged in
  Configure&quot;);                    </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                 }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                 );</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            IWebHost webHost = webHostBuilder.Build();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            webHost.Run();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            /**            </span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            if (RuntimeInformation.IsOSPlatform(OSPlatform.Windows))</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                using (RegistryKey registryKeykey =
  Registry.CurrentUser.OpenSubKey(@&quot;SOFTWARE\jbhuang99&quot;))</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    if (registryKeykey != null)</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    {</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        Object obj =
  registryKeykey.GetValue(&quot;Title&quot;);</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                        Console.WriteLine(obj.ToString());</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                    }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>                }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            else { Console.WriteLine(&quot;</span><span
  style='font-size:10.0pt;font-family:宋体'>您当前可能不是基于</span><span lang=EN-US
  style='font-size:10.0pt'>windows</span><span style='font-size:10.0pt;
  font-family:宋体'>操作系统运行本软件</span><span lang=EN-US style='font-size:10.0pt'>!</span><span
  style='font-size:10.0pt;font-family:宋体'>无法自动打开本软件默认的浏览器，将打开本机默认的浏览器作为界面运行本软件，或者，您可以自己手动打开想要的浏览器作为界面运行本软件！</span><span
  lang=EN-US style='font-size:10.0pt'>&quot;); }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //System.Diagnostics.Process processTemp = new
  System.Diagnostics.Process();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //processTemp.StartInfo.FileName = @&quot;C:\Program
  Files(x86)\Google\Chrome\Application\chrome.exe&quot;;</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>            //processTemp.Start();</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>    **/</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>        }</span></p>
  <p class=MsoNormal align=left style='margin-left:20.0pt;text-align:left;
  text-indent:-20.0pt;layout-grid-mode:char'><span lang=EN-US style='font-size:
  10.0pt'>    }</span></p>
  <p class=MsoNormal align=left style='text-align:left;text-indent:0cm;
  layout-grid-mode:char'><span lang=EN-US style='font-size:10.0pt'>}</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=left style='text-align:left;layout-grid-mode:char;
word-break:break-all'><b><span lang=EN-US style='font-size:10.0pt'>&nbsp;</span></b></p>

</div>

<div><br clear=all>

<hr align=left size=1 width="33%">

<div id=edn1>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><a href="#_ednref1" name="_edn1"
title=""></a><span lang=EN-US style='font-size:9.0pt'>[<span lang=EN-US
style='font-size:9.0pt;font-family:"Times New Roman",serif'>[1]</span>] </span><span
lang=EN-US><a
href="https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.office.interop.word?view=word-pia"><span
style='font-size:10.0pt'>https://learn.microsoft.com/zh-cn/dotnet/api/microsoft.office.interop.word?view=word-pia</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>。</span></p>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><span lang=EN-US style='font-size:
9.0pt'>VBA</span><span style='font-size:9.0pt;font-family:宋体'>说</span><span
lang=EN-US style='font-size:9.0pt'>. </span><span style='font-size:9.0pt;
font-family:宋体'>用</span><span lang=EN-US style='font-size:9.0pt'>VSTO</span><span
style='font-size:9.0pt;font-family:宋体'>做插件</span><span lang=EN-US
style='font-size:9.0pt'>[EB/OL].[2020-08-15]. </span><span lang=EN-US><a
href="https://baijiahao.baidu.com/s?id=1675107262903476586&amp;wfr=spider&amp;for=pc"><span
style='font-size:9.0pt'>https://baijiahao.baidu.com/s?id=1675107262903476586&amp;wfr=spider&amp;for=pc</span></a></span></p>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><span lang=EN-US style='font-size:
9.0pt'>Syncfusion.</span><span lang=EN-US> </span><span lang=EN-US
style='font-size:9.0pt'>blazor-word-processor[EB/OL].[2024-07-10].</span><span
lang=EN-US><a
href="https://www.syncfusion.com/blazor-components/blazor-word-processor">https://www.syncfusion.com/blazor-components/blazor-word-processor</a></span><span
style='font-size:9.0pt;font-family:宋体'>。</span></p>

</div>

<div id=edn2>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><a href="#_ednref2" name="_edn2"
title=""></a><span lang=EN-US style='font-size:9.0pt'>[<span lang=EN-US
style='font-size:9.0pt;font-family:"Times New Roman",serif'>[2]</span>] Program.cs
in ASP.NET Core. </span><span lang=EN-US><a
href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-8.0&amp;tabs=windows#programcs"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/aspnet/core/fundamentals/?view=aspnetcore-8.0&amp;tabs=windows#programcs</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>。</span></p>

</div>

<div id=edn3>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><a href="#_ednref3" name="_edn3"
title=""></a><span lang=EN-US style='font-size:9.0pt'>[<span lang=EN-US
style='font-size:9.0pt;font-family:"Times New Roman",serif'>[3]</span>] </span><span
lang=EN-US><a
href="https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>、</span><span lang=EN-US><a
href="https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection-usage"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection-usage</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>、</span><span lang=EN-US><a
href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-7.0"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-7.0</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>、</span><span lang=EN-US><a
href="https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection-guidelines"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/dotnet/core/extensions/dependency-injection-guidelines</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>。</span></p>

</div>

<div id=edn4>

<p class=MsoNormal align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;word-break:break-all'><a href="#_ednref4" name="_edn4"
title=""></a><span lang=EN-US style='font-size:9.0pt'>[<span lang=EN-US
style='font-size:9.0pt;font-family:"Times New Roman",serif'>[4]</span>]  </span><span
lang=EN-US><a
href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-7.0"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-7.0</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>、</span><span lang=EN-US><a
href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-7.0#built-in-middleware"><span
style='font-size:9.0pt'>https://learn.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-7.0#built-in-middleware</span></a></span><span
style='font-size:9.0pt;font-family:宋体'>。</span></p>

</div>

</div>

<!--右键菜单开始 --><div id='popupDiv' onclick='fnPopupClosePopup();' oncontextmenu='fnPopupContextMenu();' style='position:fixed;z-Index:1000;margin: 2px; border: 1px;   overflow:visible;  font-size: 11px; cursor: default;display:none;'><div style='position: relative;' onmouseover='fnPopupMouseOver();' onmouseout='fnPopupMouseOut();'><div title='刷新标题面' onclick='location.reload();'>刷新</div><div title='单击将在是否可以在线编辑课文的之间切换!' onclick='if(document.body.contentEditable==true) { document.body.contentEditable = false; } else { document.body.contentEditable = true;}'>课文编辑切换</div><div title='编辑后可保存编辑结果' onclick='fnSave();'>保存</div><div title='打开帮助文档' onclick='fnHelp();'>帮助</div></div></div><!--右键菜单结束--><script id=sIdScriptAutoAddedForDynFunction1 src='../../../../common/script/content.js'></script><script id=sIdScriptAutoAddedForDynFunction2 src='../../../../common/script/Popup.js'></script><script id=sIdScriptAutoAddedForDynFunction3>document.body.onload=fnOnLoad;</script></body>

</html>
