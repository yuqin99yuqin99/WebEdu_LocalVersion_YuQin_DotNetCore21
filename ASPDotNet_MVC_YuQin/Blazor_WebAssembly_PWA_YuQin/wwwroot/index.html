<!--
wwwroot folder: The Web Root folder for the app containing the app's public static assets, including appsettings.json and environmental app settings files for configuration settings and sample weather data (sample-data/weather.json).
-->
<!--
When any page of the app is initially requested, this page is rendered and returned in the response.
The page specifies where the root App component is rendered. The component is rendered at the location of the div DOM element with an id of app (<div id="app">Loading...</div>).
-->
<!--
 static files
For the location of <head> content where static file links are placed, see ASP.NET Core Blazor project structure. Static asset links can also be supplied using <HeadContent> components in individual Razor components.
    By default, publishing the app places the app's static assets, including Blazor framework files (_framework folder assets), at the root path (/) in published output. The <StaticWebAssetBasePath> property specified in the project file (.csproj) sets the base path to a non-root path:

XML

Copy
<PropertyGroup>
  <StaticWebAssetBasePath>{PATH}</StaticWebAssetBasePath>
</PropertyGroup>
In the preceding example, the {PATH} placeholder is the path.

Without setting the <StaticWebAssetBasePath> property, a standalone app is published at /BlazorStandaloneSample/bin/Release/{TFM}/publish/wwwroot/.

In the preceding example, the {TFM} placeholder is the Target Framework Moniker (TFM) (for example, net6.0).

If the <StaticWebAssetBasePath> property in a standalone Blazor WebAssembly app sets the published static asset path to app1, the root path to the app in published output is /app1.

In the standalone Blazor WebAssembly app's project file (.csproj):

XML

Copy
<PropertyGroup>
  <StaticWebAssetBasePath>app1</StaticWebAssetBasePath>
</PropertyGroup>
In published output, the path to the standalone Blazor WebAssembly app is /BlazorStandaloneSample/bin/Release/{TFM}/publish/wwwroot/app1/.

In the preceding example, the {TFM} placeholder is the Target Framework Moniker (TFM) (for example, net6.0).
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blazor_WebAssembly_PWA_Sample</title>
    <!-- <base href="/" /> -->
    <base href="https://localhost:4001/" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />

    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="Blazor_WebAssembly_PWA_Sample.styles.css" rel="stylesheet" />
    <link href="manifest.webmanifest" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
</head>

    <!--
        https://learn.microsoft.com/zh-cn/aspnet/core/blazor/fundamentals/startup?view=aspnetcore-8.0
    blazor webassembly è¯»å–index.htmlä¸­çš„æ•°æ®
    åœ¨ Blazor WebAssembly åº”ç”¨ç¨‹åºä¸­ï¼Œç”±äº index.html ä¸æ˜¯åœ¨å®¢æˆ·ç«¯è¿è¡Œæ—¶ç›´æ¥è®¿é—®çš„æ–‡ä»¶ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥é€šè¿‡ JavaScript è¯»å– index.html ä¸­çš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥è·å–ç±»ä¼¼çš„ä¿¡æ¯ï¼š

    ä½¿ç”¨ Blazor çš„ @inject æŒ‡ä»¤æ³¨å…¥ IWebAssemblyHostEnvironment æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡å¯ä»¥æä¾›å½“å‰ç¯å¢ƒçš„ä¿¡æ¯ã€‚

    ä½¿ç”¨ Blazor çš„ localStorage æˆ– sessionStorage æ¥å­˜å‚¨ä¿¡æ¯ï¼Œå¹¶åœ¨ Blazor åº”ç”¨ç¨‹åºä¸­è¯»å–ã€‚

    ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ IWebAssemblyHostEnvironment æœåŠ¡æ¥è·å–ç¯å¢ƒä¿¡æ¯ï¼š

    @inject IWebAssemblyHostEnvironment Environment

    <h1>Environment Information</h1>
    <p>IsDevelopment: @Environment.IsDevelopment()</p>
    <p>EnvironmentName: @Environment.EnvironmentName</p>
    å¦‚æœä½ éœ€è¦ä» index.html è¯»å–ç‰¹å®šçš„æ•°æ®ï¼Œå¹¶ä¸”è¿™äº›æ•°æ®æ˜¯åœ¨é¡µé¢åŠ è½½æ—¶è®¾ç½®çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ Blazor.start æ–¹æ³•æ¥ä¼ é€’åˆå§‹æ•°æ®ï¼š

    <script>
        function getDataFromIndexHtml() {
            var data = {
                customData: 'Your custom data here'
            };
            Blazor.start({ data: data });
        }
    </script>


    Blazor.start æ–¹æ³•æ¥ä¼ é€’åˆå§‹æ•°æ®:
    åœ¨Blazoråº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Blazor.startæ–¹æ³•æ¥ä¼ é€’åˆå§‹æ•°æ®ã€‚è¿™é€šå¸¸åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡Œã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š

    const initialData = {
        firstParameter: 'value1',
        secondParameter: 'value2'
    };

    Blazor.start({
        initialData: initialData
    });
    åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒinitialDataå¯¹è±¡åŒ…å«äº†ä¸¤ä¸ªå±æ€§ï¼Œè¿™äº›å±æ€§å°†ä½œä¸ºåˆå§‹æ•°æ®ä¼ é€’ç»™Blazoråº”ç”¨ç¨‹åºã€‚åœ¨Blazoråº”ç”¨ç¨‹åºçš„C#ä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡IJSRuntimeæ¥å£æ¥è®¿é—®è¿™äº›æ•°æ®ã€‚

    @inject IJSRuntime JSRuntime

    protected override async Task OnInitializedAsync()
    {
        var initialData = await JSRuntime.InvokeAsync<InitialData>("blazorExtensions.getInitialData");
        // ä½¿ç”¨initialDataä¸­çš„æ•°æ®
    }

    public class InitialData
    {
        public string FirstParameter { get; set; }
        public string SecondParameter { get; set; }
    }
    åœ¨è¿™æ®µC#ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†IJSRuntimeæ¥å£ï¼Œå¹¶åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶è°ƒç”¨InvokeAsyncæ–¹æ³•æ¥ä»JavaScriptè·å–åˆå§‹æ•°æ®ã€‚è¿™é‡Œå‡è®¾æœ‰ä¸€ä¸ªJavaScriptå‡½æ•°blazorExtensions.getInitialDataå¯ä»¥è·å–è¿™äº›æ•°æ®ï¼Œä½†å®é™…çš„å‡½æ•°åç§°å’Œç»“æ„å¯èƒ½ä¼šæ ¹æ®æ‚¨çš„å…·ä½“å®ç°è€Œæœ‰æ‰€ä¸åŒã€‚C#ä¸­çš„InitialDataç±»å‹ç”¨äºæ˜ å°„æ¥æ”¶åˆ°çš„åˆå§‹æ•°æ®ç»“æ„ã€‚

    åœ¨ Blazor åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ NavigationManager è·å–ä¼ é€’çš„æ•°æ®ï¼š

    @inject NavigationManager NavigationManager

    protected override async Task OnInitializedAsync()
    {
        var customData = NavigationManager.AppBaseUri.Split('/').Last();
        // å¤„ç†ä½ çš„æ•°æ®
    }

        æˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ªåŸºäºä»»åŠ¡çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘æƒ³åœ¨ç”¨æˆ·çœ‹åˆ°åº”ç”¨ç¨‹åºä¹‹å‰åŠ è½½â€œä¸Šä¸‹æ–‡â€æ•°æ®ï¼Œæ¯”å¦‚ä»»åŠ¡åç§°ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œè¯­è¨€å’Œå…¶ä»–ä¸œè¥¿ã€‚

    åœ¨å“ªé‡Œå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿå¦‚æœæˆ‘åœ¨App.razorçš„OnInitializedAsyncä¸­åŠ è½½æ•°æ®ï¼Œé‚£ä¹ˆåªæœ‰åœ¨åº”ç”¨ç¨‹åºå¯è§ä¹‹åï¼Œæ•°æ®æ‰ä¼šå‡ºç°ã€‚å¦‚æœæˆ‘æ ¹æ®æ¥æ”¶åˆ°çš„è¯­è¨€è®¾ç½®åŒºåŸŸæ€§ï¼Œåˆ™ç»„ä»¶å·²ç»ä½¿ç”¨é”™è¯¯çš„åŒºåŸŸæ€§å‘ˆç°ã€‚æ¯ä¸ªæ•™ç¨‹éƒ½æåˆ°Programç±»ï¼Œå°†å…¶ä½œä¸ºä»ä¸€å¼€å§‹å°±è®¾ç½®â€œåŒºåŸŸæ€§â€çš„ä½ç½®ã€‚æœ‰æ²¡æœ‰åŠæ³•å‘å‡ºå’Œç­‰å¾…è¿™ä¸ªWebApiè°ƒç”¨ï¼Œå¹¶åœ¨è®¾ç½®åŒºåŸŸæ€§å¯¹åˆå§‹å‘ˆç°äº§ç”Ÿå½±å“çš„ç‚¹ä¸Šå¡«å……æ­¤æ•°æ®ï¼Ÿ
        å°†å…¶æ”¾å…¥MainLayout.razorçš„OnInitializedAsync()æ–¹æ³•ä¸­

    æ‚¨çš„ä»£ç å¯èƒ½å¦‚ä¸‹æ‰€ç¤º

    MainLayout.razor

    ä»£ç è¯­è¨€ï¼šjavascript
    å¤åˆ¶
    <CascadingParameter Value="@mandate">
    <div class="p-4">
     @if(loading)
     {
        <p> Loading .... </p>

     }else
     {
        @Body
     }
    </div>
    </CascadingParameter>

    @code
    {
       Mandate mandate; // Assuming some Mandate class which holds information
       bool loading;
       protected override Task OnInitializedAsync()
       {
         loading = true;
         mandate = await LoadMandate(); /// load preferences from the database etc
         loading = false;
       }

    }
    ç†æƒ³æƒ…å†µä¸‹ï¼Œå°†æ­¤éƒ¨åˆ†æ¨é€åˆ°æœåŠ¡å¹¶åœ¨é‚£é‡ŒåŠ è½½å®ƒã€‚
        -->
    <body>
        <div>
            ä¸‹è¿°æ˜¯.html/.svg/.x3d/.css/.jsæ–‡ä»¶çš„è§†å›¾Vï¼Œå°†ä¸æ–­å°è¯•æ”¹å†™æˆä¸º.html/.svg/.x3d/.css/.js/.razor.csæ–‡ä»¶çš„è§†å›¾Vã€‚
        </div>
        <div>
            <iframe src="https://jbhuang99.github.io/WebEdu_LocalVersion_YuQin_DotNetCore2.1/ASPDotNet_MVC_YuQin/ASPDotNet_MVC_YuQin/wwwroot/webCourse/common/iframeInitial.html?iWidth=1024&iHeight=738" width="100%" height="768" align="middle"></iframe>
        </div>
        <div id="app">
            <!--æ‰¿æ¥Blazor WebAssemblyçš„.dllæ–‡ä»¶å…¥å£æ–‡ä»¶program.csä¸­çš„å¦‚ä¸‹ä»£ç ï¼šbuilder.RootComponents.Add<App>("#app")-->
            <svg class="loading-progress">
                <circle r="40%" cx="50%" cy="50%" />
                <circle r="40%" cx="50%" cy="50%" />
            </svg>
            <div class="loading-progress-text"></div>
        </div>

        <div id="blazor-error-ui">
            An unhandled error has occurred.
            <a href="" class="reload">Reload</a>
            <a class="dismiss">ğŸ—™</a>
        </div>
        <!--åŠ è½½Blazor WebAssemblyçš„.dllæ–‡ä»¶ã€‚ä¸€æ—¦Blazor WebAssemblyä»£ç åŠ è½½å®Œæˆï¼Œå°±ä¼šè¿è¡Œå…¥å£æ–‡ä»¶program.csä¸­çš„å¦‚ä¸‹ä»£ç ï¼šbuilder.RootComponents.Add<App>("#app");å‘Šè¯‰Rendererï¼ŒAppç±»ç»„ä»¶æ˜¯RenderTreeçš„æ ¹ç»„ä»¶ï¼Œå¹¶å°†å®ƒçš„DOMåŠ è½½åˆ°æµè§ˆå™¨DOMä¸­çš„Appå…ƒç´ ï¼ˆIdä¸ºAppçš„å…ƒç´ ï¼‰-->
        <script src="_framework/blazor.webassembly.js"></script>
        <!--åŠ è½½PWAç›¸å…³çš„ç¯å¢ƒ-->
        <script>navigator.serviceWorker.register('service-worker.js');</script>
    </body>

</html>
